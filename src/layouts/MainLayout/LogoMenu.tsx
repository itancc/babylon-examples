import MenuIcon from "@mui/icons-material/Menu";
import { useState, MouseEvent } from "react";
import {
  Typography,
  SvgIcon,
  createSvgIcon,
  Box,
  Menu,
  MenuItem,
  IconButton,
} from "@mui/material";
import { useLocation, useNavigate } from "react-router-dom";

const menuOptions = [
  {
    text: "Babylonjs",
    route: "/babylon",
    icon: createSvgIcon(
      <svg
        viewBox="0 0 1024 1024"
        xmlns="http://www.w3.org/2000/svg"
        width="32"
        height="32"
      >
        <path
          d="M511.975145 0l133.533338 77.081483-443.431345 256v357.830821l309.898007 178.918517 309.941503-178.918517V333.081483l-138.802592-80.132431 133.489842-77.081482 138.802592 80.13243v511.993786l-443.431345 256-443.381635-256V256.006214L511.975145 0z m0 672.264861l-138.752882-80.138644V431.86757l138.752882-80.132431 138.802592 80.132431v160.258647L511.975145 672.264861z"
          p-id="7058"
        ></path>
      </svg>,
      "Babylonjs"
    ),
  },
  {
    text: "WebGPU",
    route: "/webgpu",
    icon: createSvgIcon(
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="768"
        height="768"
        viewBox="0 0 768 768"
      >
        <path d="M265.5,504L24.745,87h481.51Z" />
        <path d="M506.5,87L386,295H627Z" />
        <path d="M506.5,503L386,295H627Z" />
        <path d="M626.5,296L566,192H687Z" />
        <path d="M626.5,88L566,192H687Z" />
        <path d="M168.627,547.469l-25.7,98.943-26.877-98.943H98.913L70.692,646.748,45.158,547.469H28.864L61.621,664.722l16.966-.168,28.221-94.239,27.214,94.239h17.134l33.933-117.085H168.627ZM285.879,615a46.371,46.371,0,0,0-5.459-22.594A39.572,39.572,0,0,0,264.881,576.7a46.213,46.213,0,0,0-23.181-5.711,47.756,47.756,0,0,0-23.77,5.8,40.093,40.093,0,0,0-16.043,16.547q-5.712,10.752-5.711,25.029t5.879,25.114a41.6,41.6,0,0,0,16.211,16.714,46.506,46.506,0,0,0,23.434,5.88q16.461,0,27.549-8.315a39.581,39.581,0,0,0,14.783-21.586H267.569a24.459,24.459,0,0,1-9.323,12.347q-6.637,4.621-16.546,4.619a29.643,29.643,0,0,1-20.579-7.643q-8.484-7.643-9.323-21.25h73.578a90.2,90.2,0,0,0,.5-9.239h0Zm-15.79-3.192H211.966q1.174-13.1,9.323-20.494a28.334,28.334,0,0,1,19.739-7.391,32.747,32.747,0,0,1,14.7,3.275,25.141,25.141,0,0,1,10.5,9.575,28.211,28.211,0,0,1,3.864,15.035h0Zm51.234-22.174V540.246H306.037V664.554h15.286V647.588a35.4,35.4,0,0,0,13.523,13.27,40.944,40.944,0,0,0,20.914,5.208,41.878,41.878,0,0,0,37.965-23.014,52.85,52.85,0,0,0,5.711-24.862q0-14.111-5.711-24.777A41.656,41.656,0,0,0,378.1,576.866a42.963,42.963,0,0,0-22.342-5.879,40.769,40.769,0,0,0-20.662,5.207,36.153,36.153,0,0,0-13.775,13.439h0Zm62.491,28.557a38.312,38.312,0,0,1-4.2,18.395,29.538,29.538,0,0,1-11.339,11.927,30.881,30.881,0,0,1-15.707,4.115,30.554,30.554,0,0,1-15.538-4.115,30.081,30.081,0,0,1-11.423-11.927,40.557,40.557,0,0,1,0-36.285,30.1,30.1,0,0,1,11.423-11.927,30.574,30.574,0,0,1,15.538-4.115,31.392,31.392,0,0,1,15.707,4.031,29.1,29.1,0,0,1,11.339,11.759,37.449,37.449,0,0,1,4.2,18.142h0ZM526.6,581.4a52.873,52.873,0,0,0-20.914-26.038q-14.363-9.236-33.008-9.239a59.1,59.1,0,0,0-29.734,7.643,55.966,55.966,0,0,0-21.25,21.334,64.565,64.565,0,0,0,0,61.567,56.107,56.107,0,0,0,21.25,21.25,59.068,59.068,0,0,0,29.734,7.643,56.956,56.956,0,0,0,28.053-6.971,56.039,56.039,0,0,0,20.326-18.983,58.146,58.146,0,0,0,9.071-26.457V601.392H467.133v12.431h46.7Q511.982,631.3,500.9,641.54t-28.221,10.247a43.637,43.637,0,0,1-22.091-5.627,39.867,39.867,0,0,1-15.454-16.043q-5.629-10.413-5.627-24.189t5.627-24.274a39.775,39.775,0,0,1,15.454-16.127,43.657,43.657,0,0,1,22.091-5.627,40.519,40.519,0,0,1,21.5,5.627A36.439,36.439,0,0,1,508.289,581.4H526.6Zm101.967,0.336q0-15.119-10.331-24.694t-30.153-9.575h-37.8V664.554h15.287V615.671h22.51q20.493,0,30.489-9.659t10-24.274h0Zm-40.484,21.334h-22.51v-43h22.51q24.858,0,24.861,21.67,0,10.248-6.047,15.79t-18.814,5.544h0Zm59.129-55.6v73.913q0,14.615,5.8,24.61a36.383,36.383,0,0,0,15.79,14.866,54.05,54.05,0,0,0,44.852,0,36.913,36.913,0,0,0,15.875-14.866Q735.4,636,735.4,621.382V547.469H720.117V621.55q0,15.623-7.644,23.182t-21.082,7.559q-13.606,0-21.25-7.559T662.5,621.55V547.469H647.211Z" />
      </svg>,
      "WebGPU"
    ),
  },
  {
    text: "WebGL",
    route: "/webgl",
    icon: createSvgIcon(
      <svg
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="4412"
        width="32"
        height="32"
      >
        <path
          d="M807.594667 604.970667c-9.130667 3.84-18.218667 5.76-27.434667 5.76-14.592 0-27.733333-2.517333-39.381333-7.594667a83.754667 83.754667 0 0 1-29.44-20.949333c-7.978667-8.917333-14.165333-19.328-18.432-31.36s-6.357333-25.002667-6.357334-38.869334c0-14.293333 2.133333-27.434667 6.357334-39.68 4.266667-12.245333 10.325333-22.869333 18.304-31.872a83.626667 83.626667 0 0 1 29.44-21.376 96 96 0 0 1 39.381333-7.808c9.813333 0 19.242667 1.536 28.330667 4.437334 9.130667 2.944 17.408 7.296 24.789333 12.970666s13.482667 12.757333 18.218667 21.162667a72.533333 72.533333 0 0 1 8.789333 28.842667h-39.893333c-2.517333-10.624-7.296-18.645333-14.378667-23.978667a41.514667 41.514667 0 0 0-25.898667-7.978667c-9.429333 0-17.408 1.834667-23.978666 5.461334s-11.946667 8.490667-16 14.677333c-4.053333 6.186667-7.082667 13.141333-8.917334 20.949333s-2.816 15.872-2.816 24.277334c0 7.978667 0.896 15.786667 2.816 23.381333 1.834667 7.594667 4.864 14.378667 8.917334 20.437333 4.053333 6.058667 9.429333 10.922667 16 14.592s14.592 5.461333 23.978666 5.461334c13.866667 0 24.618667-3.541333 32.170667-10.538667 7.594667-6.997333 11.946667-17.109333 13.269333-30.464h-42.112V503.466667h79.872v102.954666h-26.624l-4.266666-21.546666a61.610667 61.610667 0 0 1-24.704 20.096z m123.562666-188.970667v154.965333H1024v35.328h-134.613333V416h41.770666zM118.826667 511.957333c0-30.250667 14.634667-58.709333 40.448-83.712l47.317333 180.096h32.597333l45.866667-162.773333 45.226667 162.773333h32.682666l56.362667-207.189333h-36.693333l-36.736 158.933333-44.330667-158.976H267.946667l-44.330667 158.933334-35.84-154.965334c63.530667-43.733333 165.034667-72.106667 279.381333-72.106666 107.178667 0 203.264 22.570667 267.136 61.653333-69.632-65.493333-194.773333-111.445333-337.706666-111.530667C177.536 283.093333 0 385.536 0 511.957333s177.536 228.992 396.501333 228.992c142.421333 0 267.136-45.866667 337.066667-110.933333-63.872 38.869333-159.616 60.928-266.410667 60.928-192.426667-0.042667-348.330667-80.085333-348.330666-178.986667z m392.277333-23.594666a50.517333 50.517333 0 0 0-18.944-16.384 58.794667 58.794667 0 0 0-26.538667-5.76c-11.136 0-21.162667 2.005333-29.866666 5.973333a56.021333 56.021333 0 0 0-20.864 16.512c-10.410667 13.269333-15.872 32-15.872 54.144 0 9.813333 1.408 19.114667 4.138666 27.434667a64 64 0 0 0 12.16 21.973333c11.136 12.970667 27.008 19.84 45.952 19.84 9.941333 0 18.005333-1.024 24.789334-3.157333 5.888-1.834667 9.813333-4.266667 13.056-6.357334a57.898667 57.898667 0 0 0 18.944-20.864c3.84-7.082667 5.76-13.781333 6.186666-17.194666l0.298667-2.346667h-27.008l-0.085333 1.92c-0.725333 8.789333-12.245333 24.490667-32.810667 24.490667-29.354667 0-36.352-21.248-36.864-39.978667h98.389333v-2.133333a134.4 134.4 0 0 0-3.626666-32.682667 78.506667 78.506667 0 0 0-11.434667-25.429333z m-48.597333 2.133333c21.76 0 33.408 11.733333 35.541333 35.84h-70.442667c1.066667-19.541333 16.554667-35.84 34.901334-35.84z m199.594666 17.706667a67.2 67.2 0 0 0-11.434666-21.973334 53.333333 53.333333 0 0 0-18.645334-14.762666 58.026667 58.026667 0 0 0-25.002666-5.376 48.682667 48.682667 0 0 0-22.656 5.461333 46.933333 46.933333 0 0 0-14.762667 11.946667v-63.573334h-26.922667v188.288h25.6v-12.842666a41.130667 41.130667 0 0 0 9.002667 8.789333c7.296 5.248 16.298667 7.893333 26.709333 7.893333 11.221333 0 21.376-2.517333 29.866667-7.509333 7.594667-4.437333 14.08-10.837333 19.114667-18.944a82.346667 82.346667 0 0 0 10.026666-24.917333 113.493333 113.493333 0 0 0 2.944-25.728 84.736 84.736 0 0 0-3.84-26.752z m-24.192 30.592c0 14.762667-2.944 27.136-8.618666 35.84a29.098667 29.098667 0 0 1-25.813334 13.866666c-16.085333 0-34.944-11.221333-34.944-43.008 0-15.189333 1.92-26.922667 5.76-35.84 5.546667-12.842667 14.976-19.029333 28.629334-19.029333 14.592 0 24.405333 5.674667 29.866666 17.493333 4.522667 9.685333 5.12 21.546667 5.12 30.677334z"
          p-id="4413"
        ></path>
      </svg>,
      "WebGL"
    ),
  },
] as const;

// 获取menuOptions的类型
export type MenuOption = (typeof menuOptions)[number];

export default function LogoMenu() {
  const navigate = useNavigate();
  const { pathname } = useLocation();
  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);
  const defaultOption =
    menuOptions.find((option) => pathname.includes(option.route)) ??
    menuOptions[0];

  const [selectMenuOption, setSelectMenuOption] =
    useState<MenuOption>(defaultOption);
  const open = Boolean(anchorEl);
  const handleClick = (event: MouseEvent<HTMLElement>) => {
    setAnchorEl(event.currentTarget);
  };
  const onMenuItemClick = (option: MenuOption) => {
    setSelectMenuOption(option);
    navigate(option.route);
    handleClose();
  };
  const handleClose = () => {
    setAnchorEl(null);
  };

  const goHome = () => {
    if (pathname === selectMenuOption.route) return;
    navigate(selectMenuOption.route);
  };

  return (
    <>
      <IconButton
        aria-controls={open ? "long-menu" : undefined}
        aria-expanded={open ? "true" : undefined}
        aria-haspopup="true"
        onClick={handleClick}
      >
        <MenuIcon />
      </IconButton>
      <Menu anchorEl={anchorEl} open={open} onClose={handleClose}>
        {menuOptions.map((option) => (
          <MenuItem
            key={option.text}
            onClick={() => onMenuItemClick(option)}
            selected={selectMenuOption.text === option.text}
          >
            <SvgIcon fontSize="small" component={option.icon}></SvgIcon>
            <Typography ml={2}>{option.text}</Typography>
          </MenuItem>
        ))}
      </Menu>
      <Box display="flex" ml={2} alignItems="center" sx={{ cursor: "pointer" }}>
        <SvgIcon component={selectMenuOption.icon}></SvgIcon>

        <Typography variant="h6" ml={1} onClick={goHome}>
          {selectMenuOption.text} Examples
        </Typography>
      </Box>
    </>
  );
}
